# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = -21 # Slope
#Z = 2 # Error
A = 5.5 # Minimum (log10)
B = 7.9 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit2 <- mle2(log10(veg) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
#curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
#        (1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
#      from = -6, to = 900, add = TRUE, lty = 2, lwd = 2.5, col = "black")
curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
(1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
from = 0, to = 3, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Fit spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = 21 # Slope
#Z = 2 # Error
A = 6 # Minimum (log10)
B = 6 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit3 <- mle2(log10(spore) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
curve(coef(fit3)[[2]] + (coef(fit3)[[1]] - coef(fit3)[[2]]) /
(1 + exp((coef(fit3)[[3]] - x) / coef(fit3)[[4]])),
from = -0.5, to = 3, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png")
grid.raster(img)
png(filename="/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png",
width = 1200, height = 900, res = 96*2)
par(mar = c(5, 7, 5, 7))
plot(log10(data2$time), log10(data2$v.est*10^4), pch = 21,
bg = "grey80", cex = 1.25, col = "grey80", lwd = 0.75, cex.axis = 1.25,
xlab = NA, ylab = NA, xlim = c(-0.5, 3.2), ylim = c(4, 9), yaxt = "n", xaxt = "n")
points(log10(data2$time), log10(data2$s.est*10^4), pch = 21, lwd = 0.75, col = "grey50",
bg = "grey50", cex = 1.25)
legend(50, 9, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
y.intersp = 0.80, lwd = 0, x.intersp = -0.5)
box(lwd = 2)
#legend(350, 8.75, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
#       col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
#       y.intersp = 1.5, lwd = 0, x.intersp = -0.5)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(10^4, 10^5, 10^6, 10^7, 10^8, 10^9),
at = c(4, 5, 6, 7, 8, 9))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25,
at=c(4, 5, 6, 7, 8, 9), labels = F)
#axis(side = 1, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = T)
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(1, 10, 100, 1000),
at = c(0, 1, 2, 3))
#axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
at = c(0, 1, 2, 3), labels = F)
mtext('Time (d)', side = 1, outer = TRUE, cex = 2,
line = -2, adj = 0.5)
mtext(expression('Bacteria (CFU ml'^-1*')'), side = 2, outer = TRUE, cex = 2,
line = -3.5, adj = 0.5)
# Fit non-spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = -21 # Slope
#Z = 2 # Error
A = 5.5 # Minimum (log10)
B = 7.9 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit2 <- mle2(log10(veg) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
#curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
#        (1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
#      from = -6, to = 900, add = TRUE, lty = 2, lwd = 2.5, col = "black")
curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
(1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
from = 0, to = 3, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Fit spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = 21 # Slope
#Z = 2 # Error
A = 6 # Minimum (log10)
B = 6 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit3 <- mle2(log10(spore) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
curve(coef(fit3)[[2]] + (coef(fit3)[[1]] - coef(fit3)[[2]]) /
(1 + exp((coef(fit3)[[3]] - x) / coef(fit3)[[4]])),
from = -0.2, to = 3, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png")
grid.raster(img)
png(filename="/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png",
width = 1200, height = 900, res = 96*2)
par(mar = c(5, 7, 5, 7))
plot(log10(data2$time), log10(data2$v.est*10^4), pch = 21,
bg = "grey80", cex = 1.25, col = "grey80", lwd = 0.75, cex.axis = 1.25,
xlab = NA, ylab = NA, xlim = c(-0.5, 3.2), ylim = c(4, 9), yaxt = "n", xaxt = "n")
points(log10(data2$time), log10(data2$s.est*10^4), pch = 21, lwd = 0.75, col = "grey50",
bg = "grey50", cex = 1.25)
legend(50, 9, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
y.intersp = 0.80, lwd = 0, x.intersp = -0.5)
box(lwd = 2)
#legend(350, 8.75, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
#       col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
#       y.intersp = 1.5, lwd = 0, x.intersp = -0.5)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(10^4, 10^5, 10^6, 10^7, 10^8, 10^9),
at = c(4, 5, 6, 7, 8, 9))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25,
at=c(4, 5, 6, 7, 8, 9), labels = F)
#axis(side = 1, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = T)
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(1, 10, 100, 1000),
at = c(0, 1, 2, 3))
#axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
at = c(0, 1, 2, 3), labels = F)
mtext('Time (d)', side = 1, outer = TRUE, cex = 2,
line = -2, adj = 0.5)
mtext(expression('Bacteria (CFU ml'^-1*')'), side = 2, outer = TRUE, cex = 2,
line = -3.5, adj = 0.5)
# Fit non-spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = -21 # Slope
#Z = 2 # Error
A = 5.5 # Minimum (log10)
B = 7.9 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit2 <- mle2(log10(veg) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
#curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
#        (1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
#      from = -6, to = 900, add = TRUE, lty = 2, lwd = 2.5, col = "black")
curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
(1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
from = -0.2, to = 3, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Fit spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = 21 # Slope
#Z = 2 # Error
A = 6 # Minimum (log10)
B = 6 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit3 <- mle2(log10(spore) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
curve(coef(fit3)[[2]] + (coef(fit3)[[1]] - coef(fit3)[[2]]) /
(1 + exp((coef(fit3)[[3]] - x) / coef(fit3)[[4]])),
from = -0.2, to = 3, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png")
grid.raster(img)
png(filename="/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png",
width = 1200, height = 900, res = 96*2)
par(mar = c(5, 7, 5, 7))
plot(log10(data2$time), log10(data2$v.est*10^4), pch = 21,
bg = "grey80", cex = 1.25, col = "grey80", lwd = 0.75, cex.axis = 1.25,
xlab = NA, ylab = NA, xlim = c(-0.5, 3.2), ylim = c(4, 9), yaxt = "n", xaxt = "n")
points(log10(data2$time), log10(data2$s.est*10^4), pch = 21, lwd = 0.75, col = "grey50",
bg = "grey50", cex = 1.25)
legend(50, 9, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
y.intersp = 0.80, lwd = 0, x.intersp = -0.5)
box(lwd = 2)
#legend(350, 8.75, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
#       col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
#       y.intersp = 1.5, lwd = 0, x.intersp = -0.5)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(10^4, 10^5, 10^6, 10^7, 10^8, 10^9),
at = c(4, 5, 6, 7, 8, 9))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25,
at=c(4, 5, 6, 7, 8, 9), labels = F)
#axis(side = 1, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = T)
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(1, 10, 100, 1000),
at = c(0, 1, 2, 3))
#axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
at = c(0, 1, 2, 3), labels = F)
mtext('Time (d)', side = 1, outer = TRUE, cex = 1.5,
line = -2, adj = 0.5)
mtext(expression('Bacteria (CFU ml'^-1*')'), side = 2, outer = TRUE, cex = 1.5,
line = -3.5, adj = 0.5)
# Fit non-spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = -21 # Slope
#Z = 2 # Error
A = 5.5 # Minimum (log10)
B = 7.9 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit2 <- mle2(log10(veg) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
#curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
#        (1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
#      from = -6, to = 900, add = TRUE, lty = 2, lwd = 2.5, col = "black")
curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
(1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
from = -0.2, to = 3.2, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Fit spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = 21 # Slope
#Z = 2 # Error
A = 6 # Minimum (log10)
B = 6 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit3 <- mle2(log10(spore) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
curve(coef(fit3)[[2]] + (coef(fit3)[[1]] - coef(fit3)[[2]]) /
(1 + exp((coef(fit3)[[3]] - x) / coef(fit3)[[4]])),
from = -0.2, to = 3.2, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png")
grid.raster(img)
png(filename="/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png",
width = 1200, height = 900, res = 96*2)
par(mar = c(5, 7, 5, 7))
plot(log10(data2$time), log10(data2$v.est*10^4), pch = 21,
bg = "grey80", cex = 1.25, col = "grey80", lwd = 0.75, cex.axis = 1.25,
xlab = NA, ylab = NA, xlim = c(-0.5, 3.2), ylim = c(4, 9), yaxt = "n", xaxt = "n")
points(log10(data2$time), log10(data2$s.est*10^4), pch = 21, lwd = 0.75, col = "grey50",
bg = "grey50", cex = 1.25)
legend(50, 9, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
y.intersp = 0.80, lwd = 0, x.intersp = -0.5)
box(lwd = 2)
#legend(350, 8.75, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
#       col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
#       y.intersp = 1.5, lwd = 0, x.intersp = -0.5)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(10^4, 10^5, 10^6, 10^7, 10^8, 10^9),
at = c(4, 5, 6, 7, 8, 9))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25,
at=c(4, 5, 6, 7, 8, 9), labels = F)
#axis(side = 1, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = T)
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(1, 10, 100, 1000),
at = c(0, 1, 2, 3))
#axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
at = c(0, 1, 2, 3), labels = F)
mtext('Time (d)', side = 1, outer = TRUE, cex = 1.5,
line = -2, adj = 0.5)
mtext(expression('Bacteria (CFU ml'^-1*')'), side = 2, outer = TRUE, cex = 1.5,
line = -3.5, adj = 0.5)
# Fit non-spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = -21 # Slope
#Z = 2 # Error
A = 5.5 # Minimum (log10)
B = 7.9 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit2 <- mle2(log10(veg) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
#curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
#        (1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
#      from = -6, to = 900, add = TRUE, lty = 2, lwd = 2.5, col = "black")
curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
(1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
from = -0.2, to = 3.1, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Fit spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = 21 # Slope
#Z = 2 # Error
A = 6 # Minimum (log10)
B = 6 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit3 <- mle2(log10(spore) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
curve(coef(fit3)[[2]] + (coef(fit3)[[1]] - coef(fit3)[[2]]) /
(1 + exp((coef(fit3)[[3]] - x) / coef(fit3)[[4]])),
from = -0.2, to = 3.1, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png")
grid.raster(img)
png(filename="/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png",
width = 1200, height = 900, res = 96*2)
par(mar = c(5, 7, 5, 7))
plot(log10(data2$time), log10(data2$v.est*10^4), pch = 21,
bg = "grey80", cex = 1.25, col = "grey80", lwd = 0.75, cex.axis = 1.25,
xlab = NA, ylab = NA, xlim = c(-0.5, 3.2), ylim = c(4, 9), yaxt = "n", xaxt = "n")
points(log10(data2$time), log10(data2$s.est*10^4), pch = 21, lwd = 0.75, col = "grey50",
bg = "grey50", cex = 1.25)
legend(50, 9, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
y.intersp = 0.80, lwd = 0, x.intersp = -0.5)
box(lwd = 2)
#legend(350, 8.75, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
#       col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
#       y.intersp = 1.5, lwd = 0, x.intersp = -0.5)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(10^4, 10^5, 10^6, 10^7, 10^8, 10^9),
at = c(4, 5, 6, 7, 8, 9))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25,
at=c(4, 5, 6, 7, 8, 9), labels = F)
#axis(side = 1, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = T)
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(1, 10, 100, 1000),
at = c(0, 1, 2, 3))
#axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
at = c(0, 1, 2, 3), labels = F)
mtext('Time (d)', side = 1, outer = TRUE, cex = 1.5,
line = -2, adj = 0.5)
mtext(expression('Bacteria (CFU ml'^-1*')'), side = 2, outer = TRUE, cex = 1.5,
line = -3.5, adj = 0.5)
# Fit non-spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = -21 # Slope
#Z = 2 # Error
A = 5.5 # Minimum (log10)
B = 7.9 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit2 <- mle2(log10(veg) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
#curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
#        (1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
#      from = -6, to = 900, add = TRUE, lty = 2, lwd = 2.5, col = "black")
curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
(1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
from = -0.22, to = 3.1, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Fit spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = 21 # Slope
#Z = 2 # Error
A = 6 # Minimum (log10)
B = 6 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit3 <- mle2(log10(spore) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
curve(coef(fit3)[[2]] + (coef(fit3)[[1]] - coef(fit3)[[2]]) /
(1 + exp((coef(fit3)[[3]] - x) / coef(fit3)[[4]])),
from = -0.22, to = 3.1, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png")
grid.raster(img)
png(filename="/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png",
width = 1200, height = 900, res = 96*2)
par(mar = c(5, 7, 5, 7))
plot(log10(data2$time), log10(data2$v.est*10^4), pch = 21,
bg = "grey80", cex = 1.25, col = "grey80", lwd = 0.75, cex.axis = 1.25,
xlab = NA, ylab = NA, xlim = c(-0.5, 3.2), ylim = c(4, 9), yaxt = "n", xaxt = "n")
points(log10(data2$time), log10(data2$s.est*10^4), pch = 21, lwd = 0.75, col = "grey50",
bg = "grey50", cex = 1.25)
legend(50, 9, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
y.intersp = 0.80, lwd = 0, x.intersp = -0.5)
box(lwd = 2)
#legend(350, 8.75, c("Spore", "Non-spore"), pch = 21, pt.bg = c("grey50", "grey80"),
#       col = c("grey50", "grey80"), pt.cex = 1.25, pt.lwd = 0.75, bty = 'n',
#       y.intersp = 1.5, lwd = 0, x.intersp = -0.5)
axis(side = 2, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(10^4, 10^5, 10^6, 10^7, 10^8, 10^9),
at = c(4, 5, 6, 7, 8, 9))
axis(side = 4, lwd.ticks = 2, cex.axis = 1.25,
at=c(4, 5, 6, 7, 8, 9), labels = F)
#axis(side = 1, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = T)
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1,
labels = expression(1, 10, 100, 1000),
at = c(0, 1, 2, 3))
#axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
#     at = c(0, 200, 400, 600, 800), labels = F)
axis(side = 3, lwd.ticks = 2, cex.axis = 1.25,
at = c(0, 1, 2, 3), labels = F)
mtext('Time (d)', side = 1, outer = TRUE, cex = 1.5,
line = -2, adj = 0.5)
mtext(expression('Bacteria (CFU ml'^-1*')'), side = 2, outer = TRUE, cex = 1.5,
line = -3.5, adj = 0.5)
# Fit non-spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = -21 # Slope
#Z = 2 # Error
A = 5.5 # Minimum (log10)
B = 7.9 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit2 <- mle2(log10(veg) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
#curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
#        (1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
#      from = -6, to = 900, add = TRUE, lty = 2, lwd = 2.5, col = "black")
curve(coef(fit2)[[2]] + (coef(fit2)[[1]] - coef(fit2)[[2]]) /
(1 + exp((coef(fit2)[[3]] - x) / coef(fit2)[[4]])),
from = -0.24, to = 3.05, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Fit spore abundance with sigmoidal function using MLE
# Initial parameters
#A = 6 # Maximum
#B = 6 # Minimum
#M = 5 # Midpoint
#W = 21 # Slope
#Z = 2 # Error
A = 6 # Minimum (log10)
B = 6 # Maximum (log10)
M = 0.7 # Midpoint (log10)
W = 0.16 # Slope
Z = 0.2 # Error
# Function
fit3 <- mle2(log10(spore) ~ dnorm(mean = b + (a - b) / (1 + exp((m - log10(time)) / w)), sd = z),
start = list(a = A, b = B, m = M, w = W, z = Z), data = data.all)
curve(coef(fit3)[[2]] + (coef(fit3)[[1]] - coef(fit3)[[2]]) /
(1 + exp((coef(fit3)[[3]] - x) / coef(fit3)[[4]])),
from = -0.24, to = 3.05, add = TRUE, lty = 2, lwd = 2.5, col = "black")
# Close Plot Device
dev.off()
graphics.off()
# Show Plot
img <- readPNG("/Users/lennonj/GitHub/SporeMut/output/1.PopDynamics/1.PopDynamics_Log.png")
grid.raster(img)
